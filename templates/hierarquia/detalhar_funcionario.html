{% extends 'base.html' %} {# Ou 'hierarquia/base.html' #}
{% load static %}

{% block title %}{{ funcionario.nome }} - Sistema de Hierarquia{% endblock title %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/detalhar_funcionario.css' %}">
{% endblock extra_css %}

{% block content %}
<div class="container">
    <div class="header">
        <h2>{{ funcionario.nome }}</h2>
    </div>

    <div class="card">
        <h3>Informações Pessoais</h3>
        <div class="info-grid">
            <div class="info-item">
                <div class="info-label">CPF</div>
                <div class="info-value">{{ funcionario.cpf }}</div>
            </div>
            {% if funcionario.data_nascimento %}
            <div class="info-item">
                <div class="info-label">Data de Nascimento</div>
                <div class="info-value">{{ funcionario.data_nascimento|date:"d/m/Y" }}</div>
            </div>
            {% endif %}
            <div class="info-item">
                <div class="info-label">Data de Admissão</div>
                <div class="info-value">{{ funcionario.data_admissao|date:"d/m/Y" }}</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h3>Informações Profissionais</h3>
        <div class="info-grid">
            <div class="info-item">
                <div class="info-label">Cargo</div>
                <div class="info-value">{{ funcionario.cargo.nome }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Nível Hierárquico</div>
                <div class="info-value">Nível {{ funcionario.cargo.nivel }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Setores</div> {# Corrigido para plural #}
                <div class="info-value">
                    {% for setor in funcionario.setor.all %}
                        {{ setor.nome }}{% if not forloop.last %}, {% endif %}
                    {% empty %}
                        Nenhum setor associado.
                    {% endfor %}
                </div>
            </div>
            {% if funcionario.centro_servico %}
            <div class="info-item">
                <div class="info-label">Centro de Serviço</div>
                <div class="info-value">{{ funcionario.centro_servico.nome }}</div>
            </div>
            {% endif %}
        </div>
    </div>

    {# Bloco Superiores - Usando {% empty %} em vez de if/else #}
    <div class="card">
        <h3>Superiores Hierárquicos</h3>
        <div class="info-grid">
            {% for superior in superiores %}
            <div class="info-item">
                <div class="info-label">{{ superior.cargo.nome }}</div>
                <div class="info-value">
                    <a href="{% url 'detalhar_funcionario' superior.id %}">
                        {{ superior.nome }} →
                    </a>
                </div>
            </div>
            {% empty %}
            <div class="info-item empty-state" style="grid-column: 1 / -1;"> {# Ocupa toda a largura do grid #}
                <p>Nenhum superior hierárquico</p>
            </div>
            {% endfor %}
        </div>
    </div>

    {# Bloco Subordinados - Usando {% empty %} #}
    <div class="card">
        <h3>Subordinados</h3>
        <div class="info-grid">
            {% for subordinado in subordinados %}
            <div class="info-item">
                <div class="info-label">{{ subordinado.cargo.nome }}</div>
                <div class="info-value">
                    <a href="{% url 'detalhar_funcionario' subordinado.id %}">
                        {{ subordinado.nome }} →
                    </a>
                </div>
            </div>
            {% empty %}
             <div class="info-item empty-state" style="grid-column: 1 / -1;">
                <p>Nenhum subordinado</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <a href="{% url 'listar_setores_funcionarios' %}" class="btn">← Voltar à Lista</a>
</div>
{% endblock content %}